<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Probability â€¢ qss</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">qss</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Probability</h1>
            
          </div>

    
    
<div class="contents">
<div id="chapter-6-probability" class="section level1">
<h1 class="hasAnchor">
<html><body><a href="#chapter-6-probability" class="anchor"> </a></body></html>Chapter 6: Probability</h1>
<div id="section-6-1-probability" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-6-1-probability" class="anchor"> </a></body></html>Section 6.1: Probability</h2>
<div id="section-6-1-1-frequentist-versus-bayesian" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-1-1-frequentist-versus-bayesian" class="anchor"> </a></body></html>Section 6.1.1: Frequentist versus Bayesian</h3>
</div>
<div id="section-6-1-2-definition-and-axioms" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-1-2-definition-and-axioms" class="anchor"> </a></body></html>Section 6.1.2: Definition and Axioms</h3>
</div>
<div id="section-6-1-3-permutations" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-1-3-permutations" class="anchor"> </a></body></html>Section 6.1.3: Permutations</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>))
birthday &lt;-<span class="st"> </span>function(k) {
    logdenom &lt;-<span class="st"> </span>k *<span class="st"> </span><span class="kw">log</span>(<span class="dv">365</span>) +<span class="st"> </span><span class="kw">lfactorial</span>(<span class="dv">365</span> -<span class="st"> </span>k) <span class="co"># log denominator</span>
    lognumer &lt;-<span class="st"> </span><span class="kw">lfactorial</span>(<span class="dv">365</span>) <span class="co"># log numerator</span>
    ## P(at least two have the same bday) = 1 - P(nobody has the same bday)
    pr &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">exp</span>(lognumer -<span class="st"> </span>logdenom) <span class="co"># transform back</span>
    <span class="kw">return</span>(pr)
}

k &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">50</span>
bday &lt;-<span class="st"> </span><span class="kw">birthday</span>(k)  <span class="co"># call the function</span>
<span class="kw">names</span>(bday) &lt;-<span class="st"> </span>k  <span class="co"># add labels</span>
<span class="kw">plot</span>(k, bday, <span class="dt">xlab =</span> <span class="st">"Number of people"</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),
     <span class="dt">ylab =</span> <span class="st">"Probability that at least two</span><span class="ch">\n</span><span class="st"> people have the same birthday"</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.5</span>) <span class="co"># horizontal 0.5 line</span></code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bday[<span class="dv">20</span>:<span class="dv">25</span>]</code></pre></div>
<pre><code>##        20        21        22        23        24        25 
## 0.4114384 0.4436883 0.4756953 0.5072972 0.5383443 0.5686997</code></pre>
</div>
<div id="section-6-1-4-sampling-with-and-without-replacement" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-1-4-sampling-with-and-without-replacement" class="anchor"> </a></body></html>Section 6.1.4: Sampling With and Without Replacement</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k &lt;-<span class="st"> </span><span class="dv">23</span> <span class="co"># number of people</span>
sims &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># number of simulations</span>
event &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co"># counter</span>

for (i in <span class="dv">1</span>:sims) {
    days &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">365</span>, k, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    days.unique &lt;-<span class="st"> </span><span class="kw">unique</span>(days) <span class="co"># unique birthdays</span>
    ## if there are duplicates, the number of unique birthdays
    ## will be less than the number of birthdays, which is `k'
    if (<span class="kw">length</span>(days.unique) &lt;<span class="st"> </span>k) {
        event &lt;-<span class="st"> </span>event +<span class="st"> </span><span class="dv">1</span>
    }
}

## fraction of trials where at least two bdays are the same
answer &lt;-<span class="st"> </span>event /<span class="st"> </span>sims
answer</code></pre></div>
<pre><code>## [1] 0.513</code></pre>
</div>
<div id="section-6-1-5-combinations" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-1-5-combinations" class="anchor"> </a></body></html>Section 6.1.5: Combinations</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">choose</span>(<span class="dv">84</span>, <span class="dv">6</span>)</code></pre></div>
<pre><code>## [1] 406481544</code></pre>
</div>
</div>
<div id="section-6-2-conditional-probability" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-6-2-conditional-probability" class="anchor"> </a></body></html>Section 6.2: Conditional Probability</h2>
<div id="section-6-2-1-conditional-marginal-and-joint-probabilities" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-2-1-conditional-marginal-and-joint-probabilities" class="anchor"> </a></body></html>Section 6.2.1: Conditional, Marginal, and Joint Probabilities</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"FLVoters"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)
<span class="kw">dim</span>(FLVoters) <span class="co"># before removal of missing data</span></code></pre></div>
<pre><code>## [1] 10000     6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FLVoters &lt;-<span class="st"> </span><span class="kw">na.omit</span>(FLVoters)
<span class="kw">dim</span>(FLVoters) <span class="co"># after removal</span></code></pre></div>
<pre><code>## [1] 9113    6</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">margin.race &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(FLVoters$race))
margin.race</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">asian</th>
<th align="right">black</th>
<th align="right">hispanic</th>
<th align="right">native</th>
<th align="right">other</th>
<th align="right">white</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.0192033</td>
<td align="right">0.1310216</td>
<td align="right">0.1308022</td>
<td align="right">0.0031823</td>
<td align="right">0.0340173</td>
<td align="right">0.6817733</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">margin.gender &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(FLVoters$gender))
margin.gender</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">f</th>
<th align="right">m</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.5358279</td>
<td align="right">0.4641721</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">prop.table</span>(<span class="kw">table</span>(FLVoters$race[FLVoters$gender ==<span class="st"> "f"</span>]))</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">asian</th>
<th align="right">black</th>
<th align="right">hispanic</th>
<th align="right">native</th>
<th align="right">other</th>
<th align="right">white</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.0169977</td>
<td align="right">0.1388491</td>
<td align="right">0.1363916</td>
<td align="right">0.0034815</td>
<td align="right">0.0323572</td>
<td align="right">0.671923</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">joint.p &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="dt">race =</span> FLVoters$race, <span class="dt">gender =</span> FLVoters$gender))
joint.p</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">race/gender</th>
<th align="right">f</th>
<th align="right">m</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">asian</td>
<td align="right">0.0091079</td>
<td align="right">0.0100955</td>
</tr>
<tr class="even">
<td align="left">black</td>
<td align="right">0.0743992</td>
<td align="right">0.0566224</td>
</tr>
<tr class="odd">
<td align="left">hispanic</td>
<td align="right">0.0730824</td>
<td align="right">0.0577197</td>
</tr>
<tr class="even">
<td align="left">native</td>
<td align="right">0.0018655</td>
<td align="right">0.0013168</td>
</tr>
<tr class="odd">
<td align="left">other</td>
<td align="right">0.0173379</td>
<td align="right">0.0166795</td>
</tr>
<tr class="even">
<td align="left">white</td>
<td align="right">0.3600351</td>
<td align="right">0.3217382</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rowSums</span>(joint.p)</code></pre></div>
<pre><code>##       asian       black    hispanic      native       other       white 
## 0.019203336 0.131021617 0.130802151 0.003182267 0.034017338 0.681773291</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(joint.p)</code></pre></div>
<pre><code>##         f         m 
## 0.5358279 0.4641721</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FLVoters$age.group &lt;-<span class="st"> </span><span class="ot">NA</span> <span class="co"># initialize a variable</span>
FLVoters$age.group[FLVoters$age &lt;=<span class="st"> </span><span class="dv">20</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
FLVoters$age.group[FLVoters$age &gt;<span class="st"> </span><span class="dv">20</span> &amp;<span class="st"> </span>FLVoters$age &lt;=<span class="st"> </span><span class="dv">40</span>] &lt;-<span class="st"> </span><span class="dv">2</span>
FLVoters$age.group[FLVoters$age &gt;<span class="st"> </span><span class="dv">40</span> &amp;<span class="st"> </span>FLVoters$age &lt;=<span class="st"> </span><span class="dv">60</span>] &lt;-<span class="st"> </span><span class="dv">3</span>
FLVoters$age.group[FLVoters$age &gt;<span class="st"> </span><span class="dv">60</span>] &lt;-<span class="st"> </span><span class="dv">4</span>

joint3 &lt;-
<span class="st">    </span><span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="dt">race =</span> FLVoters$race, <span class="dt">age.group =</span> FLVoters$age.group,
                     <span class="dt">gender =</span> FLVoters$gender))
joint3</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">race</th>
<th align="left">age.group</th>
<th align="left">gender</th>
<th align="right">Freq</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">asian</td>
<td align="left">1</td>
<td align="left">f</td>
<td align="right">0.0001097</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0002195</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">2</td>
<td align="left">f</td>
<td align="right">0.0026336</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0028531</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left">f</td>
<td align="right">0.0041699</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0051575</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">4</td>
<td align="left">f</td>
<td align="right">0.0021947</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0018655</td>
</tr>
<tr class="odd">
<td align="left">black</td>
<td align="left">1</td>
<td align="left">f</td>
<td align="right">0.0016460</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0016460</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">2</td>
<td align="left">f</td>
<td align="right">0.0280917</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0228245</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left">f</td>
<td align="right">0.0257873</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0189839</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">4</td>
<td align="left">f</td>
<td align="right">0.0188741</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0131680</td>
</tr>
<tr class="odd">
<td align="left">hispanic</td>
<td align="left">1</td>
<td align="left">f</td>
<td align="right">0.0015363</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0016460</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">2</td>
<td align="left">f</td>
<td align="right">0.0260068</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0197520</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left">f</td>
<td align="right">0.0273236</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0221661</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">4</td>
<td align="left">f</td>
<td align="right">0.0182157</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0141556</td>
</tr>
<tr class="odd">
<td align="left">native</td>
<td align="left">1</td>
<td align="left">f</td>
<td align="right">0.0001097</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">2</td>
<td align="left">f</td>
<td align="right">0.0004389</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0004389</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left">f</td>
<td align="right">0.0006584</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0003292</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">4</td>
<td align="left">f</td>
<td align="right">0.0006584</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0005487</td>
</tr>
<tr class="odd">
<td align="left">other</td>
<td align="left">1</td>
<td align="left">f</td>
<td align="right">0.0003292</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0004389</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">2</td>
<td align="left">f</td>
<td align="right">0.0062548</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0069132</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left">f</td>
<td align="right">0.0058159</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0055964</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">4</td>
<td align="left">f</td>
<td align="right">0.0049380</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0037309</td>
</tr>
<tr class="odd">
<td align="left">white</td>
<td align="left">1</td>
<td align="left">f</td>
<td align="right">0.0059256</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0040601</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">2</td>
<td align="left">f</td>
<td align="right">0.0796664</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.0750576</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3</td>
<td align="left">f</td>
<td align="right">0.1260836</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.1184023</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">4</td>
<td align="left">f</td>
<td align="right">0.1483595</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left">m</td>
<td align="right">0.1242181</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## marginal probabilities for age groups
margin.age &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(FLVoters$age.group))
margin.age</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.0176671</td>
<td align="right">0.2709316</td>
<td align="right">0.360474</td>
<td align="right">0.3509272</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## P(black and female | above 60)
joint3[<span class="st">"black"</span>, <span class="dv">4</span>, <span class="st">"f"</span>] /<span class="st"> </span>margin.age[<span class="dv">4</span>]</code></pre></div>
<pre><code>##          4 
## 0.05378361</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## two-way joint probability table for age group and gender
joint2 &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(<span class="dt">age.group =</span> FLVoters$age.group,
                           <span class="dt">gender =</span> FLVoters$gender))
joint2</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">age.group/gender</th>
<th align="right">f</th>
<th align="right">m</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.0096565</td>
<td align="right">0.0080105</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">0.1430923</td>
<td align="right">0.1278394</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">0.1898387</td>
<td align="right">0.1706354</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">0.1932404</td>
<td align="right">0.1576868</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">joint2[<span class="dv">4</span>, <span class="st">"f"</span>] <span class="co"># P(above 60 and female)</span></code></pre></div>
<pre><code>## [1] 0.1932404</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## P(black | female and above 60)
joint3[<span class="st">"black"</span>, <span class="dv">4</span>, <span class="st">"f"</span>] /<span class="st"> </span>joint2[<span class="dv">4</span>, <span class="st">"f"</span>]</code></pre></div>
<pre><code>## [1] 0.09767178</code></pre>
</div>
<div id="section-6-2-2-independence" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-2-2-independence" class="anchor"> </a></body></html>Section 6.2.2: Independence</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">plot</span>(<span class="kw">c</span>(margin.race *<span class="st"> </span>margin.gender[<span class="st">"f"</span>]), <span class="co"># product of marginal probs.</span>
     <span class="kw">c</span>(joint.p[, <span class="st">"f"</span>]), <span class="co"># joint probabilities</span>
     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>),
     <span class="dt">xlab =</span> <span class="st">"P(race) * P(female)"</span>, <span class="dt">ylab =</span> <span class="st">"P(race and female)"</span>)
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 45 degree line</span></code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.5</span>)

## joint independence
<span class="kw">plot</span>(<span class="kw">c</span>(joint3[, <span class="dv">4</span>, <span class="st">"f"</span>]), <span class="co"># joint probability</span>
     margin.race *<span class="st"> </span>margin.age[<span class="dv">4</span>] *<span class="st"> </span>margin.gender[<span class="st">"f"</span>], <span class="co"># product of marginals</span>
     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">main =</span> <span class="st">"Joint independence"</span>,
     <span class="dt">xlab =</span> <span class="st">"P(race and above 60 and female)"</span>,
     <span class="dt">ylab =</span> <span class="st">"P(race) * P(above 60) * P(female)"</span>)
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## conditional independence given female
<span class="kw">plot</span>(<span class="kw">c</span>(joint3[, <span class="dv">4</span>, <span class="st">"f"</span>]) /<span class="st"> </span>margin.gender[<span class="st">"f"</span>], <span class="co"># joint prob. given female</span>
     ## product of marginals
     (joint.p[, <span class="st">"f"</span>] /<span class="st"> </span>margin.gender[<span class="st">"f"</span>]) *
<span class="st">         </span>(joint2[<span class="dv">4</span>, <span class="st">"f"</span>] /<span class="st"> </span>margin.gender[<span class="st">"f"</span>]),
     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>), <span class="dt">main =</span> <span class="st">"Marginal independence"</span>,
     <span class="dt">xlab =</span> <span class="st">"P(race and above 60 | female)"</span>,
     <span class="dt">ylab =</span> <span class="st">"P(race | female) * P(above 60 | female)"</span>)
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-6-3.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sims &lt;-<span class="st"> </span><span class="dv">1000</span>
doors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"goat"</span>, <span class="st">"goat"</span>, <span class="st">"car"</span>)
result.switch &lt;-<span class="st"> </span>result.noswitch &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, sims)

for (i in <span class="dv">1</span>:sims) {
    ## randomly choose the initial door
    first &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">size =</span> <span class="dv">1</span>)
    result.noswitch[i] &lt;-<span class="st"> </span>doors[first]
    remain &lt;-<span class="st"> </span>doors[-first] <span class="co"># remaining two doors</span>
    ## Monty chooses one door with a goat
    monty &lt;-<span class="st"> </span><span class="kw">sample</span>((<span class="dv">1</span>:<span class="dv">2</span>)[remain ==<span class="st"> "goat"</span>], <span class="dt">size =</span> <span class="dv">1</span>)
    result.switch[i] &lt;-<span class="st"> </span>remain[-monty]
}

<span class="kw">mean</span>(result.noswitch ==<span class="st"> "car"</span>)</code></pre></div>
<pre><code>## [1] 0.349</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(result.switch ==<span class="st"> "car"</span>)</code></pre></div>
<pre><code>## [1] 0.651</code></pre>
</div>
<div id="section-6-2-4-predicting-race-using-surname-and-residence-location" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-2-4-predicting-race-using-surname-and-residence-location" class="anchor"> </a></body></html>Section 6.2.4: Predicting Race Using Surname and Residence Location</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"cnames"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)
<span class="kw">dim</span>(cnames)</code></pre></div>
<pre><code>## [1] 151671      7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"yellow"</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"orange"</span>, <span class="st">"blue"</span>)

## match x with y
<span class="kw">match</span>(x, y) <span class="co"># `blue' appears in the 2nd element of y</span></code></pre></div>
<pre><code>## [1]  2 NA NA</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## match y with x
<span class="kw">match</span>(y, x) <span class="co"># `blue' appears in the 1st element of x</span></code></pre></div>
<pre><code>## [1] NA  1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">FLVoters &lt;-<span class="st"> </span>FLVoters[!<span class="kw">is.na</span>(<span class="kw">match</span>(FLVoters$surname, cnames$surname)), ]
<span class="kw">dim</span>(FLVoters)</code></pre></div>
<pre><code>## [1] 8022    7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">whites &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "white"</span>))
w.indx &lt;-<span class="st"> </span><span class="kw">match</span>(whites$surname, cnames$surname)
<span class="kw">head</span>(w.indx)</code></pre></div>
<pre><code>## [1]  8610   237  4131  2244 27852  3495</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## relevant variables
vars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"pctwhite"</span>, <span class="st">"pctblack"</span>, <span class="st">"pctapi"</span>, <span class="st">"pcthispanic"</span>, <span class="st">"pctothers"</span>)
<span class="kw">mean</span>(<span class="kw">apply</span>(cnames[w.indx, vars], <span class="dv">1</span>, max) ==<span class="st"> </span>cnames$pctwhite[w.indx])</code></pre></div>
<pre><code>## [1] 0.950218</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## blacks
blacks &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "black"</span>))
b.indx &lt;-<span class="st"> </span><span class="kw">match</span>(blacks$surname, cnames$surname)

<span class="kw">mean</span>(<span class="kw">apply</span>(cnames[b.indx, vars], <span class="dv">1</span>, max) ==<span class="st"> </span>cnames$pctblack[b.indx])</code></pre></div>
<pre><code>## [1] 0.1604824</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Hispanics
hispanics &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "hispanic"</span>))
h.indx &lt;-<span class="st"> </span><span class="kw">match</span>(hispanics$surname, cnames$surname)

<span class="kw">mean</span>(<span class="kw">apply</span>(cnames[h.indx, vars], <span class="dv">1</span>, max) ==<span class="st"> </span>cnames$pcthispanic[h.indx])</code></pre></div>
<pre><code>## [1] 0.8465298</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Asians
asians &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "asian"</span>))
a.indx &lt;-<span class="st"> </span><span class="kw">match</span>(asians$surname, cnames$surname)

<span class="kw">mean</span>(<span class="kw">apply</span>(cnames[a.indx, vars], <span class="dv">1</span>, max) ==<span class="st"> </span>cnames$pctapi[a.indx])</code></pre></div>
<pre><code>## [1] 0.5642857</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">indx &lt;-<span class="st"> </span><span class="kw">match</span>(FLVoters$surname, cnames$surname)

## whites false discovery rate
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(cnames[indx, vars], <span class="dv">1</span>, max) ==
<span class="st">                           </span>cnames$pctwhite[indx]] ==<span class="st"> "white"</span>)</code></pre></div>
<pre><code>## [1] 0.1973603</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## black false discovery rate
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(cnames[indx, vars], <span class="dv">1</span>, max) ==
<span class="st">                           </span>cnames$pctblack[indx]] ==<span class="st"> "black"</span>)</code></pre></div>
<pre><code>## [1] 0.3294574</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Hispanic false discovery rate
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(cnames[indx, vars], <span class="dv">1</span>, max) ==
<span class="st">                           </span>cnames$pcthispanic[indx]] ==<span class="st"> "hispanic"</span>)</code></pre></div>
<pre><code>## [1] 0.2274755</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Asian false discovery rate
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(cnames[indx, vars], <span class="dv">1</span>, max) ==
<span class="st">                           </span>cnames$pctapi[indx]] ==<span class="st"> "asian"</span>)</code></pre></div>
<pre><code>## [1] 0.3416667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"FLCensus"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)

## compute proportions by applying weighted.mean() to each column
race.prop &lt;-
<span class="st">    </span><span class="kw">apply</span>(FLCensus[, <span class="kw">c</span>(<span class="st">"white"</span>, <span class="st">"black"</span>, <span class="st">"api"</span>, <span class="st">"hispanic"</span>, <span class="st">"others"</span>)],
          <span class="dv">2</span>, weighted.mean, <span class="dt">weights =</span> FLCensus$total.pop)

race.prop <span class="co"># race proportions in Florida</span></code></pre></div>
<pre><code>##      white      black        api   hispanic     others 
## 0.60451586 0.13941679 0.02186662 0.21279972 0.02140101</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">total.count &lt;-<span class="st"> </span><span class="kw">sum</span>(cnames$count)

## P(surname | race) = P(race | surname) * P(surname) / P(race)
cnames$name.white &lt;-<span class="st"> </span>(cnames$pctwhite /<span class="st"> </span><span class="dv">100</span>) *
<span class="st">    </span>(cnames$count /<span class="st"> </span>total.count) /<span class="st"> </span>race.prop[<span class="st">"white"</span>]

cnames$name.black &lt;-<span class="st"> </span>(cnames$pctblack /<span class="st"> </span><span class="dv">100</span>) *
<span class="st">    </span>(cnames$count /<span class="st"> </span>total.count) /<span class="st"> </span>race.prop[<span class="st">"black"</span>]

cnames$name.hispanic &lt;-<span class="st"> </span>(cnames$pcthispanic /<span class="st"> </span><span class="dv">100</span>) *
<span class="st">    </span>(cnames$count /<span class="st"> </span>total.count) /<span class="st"> </span>race.prop[<span class="st">"hispanic"</span>]

cnames$name.asian &lt;-<span class="st"> </span>(cnames$pctapi /<span class="st"> </span><span class="dv">100</span>) *
<span class="st">    </span>(cnames$count /<span class="st"> </span>total.count) /<span class="st"> </span>race.prop[<span class="st">"api"</span>]

cnames$name.others &lt;-<span class="st"> </span>(cnames$pctothers /<span class="st"> </span><span class="dv">100</span>) *
<span class="st">    </span>(cnames$count /<span class="st"> </span>total.count) /<span class="st"> </span>race.prop[<span class="st">"others"</span>]

FLVoters &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="dt">x =</span> FLVoters, <span class="dt">y =</span> FLCensus, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">"county"</span>, <span class="st">"VTD"</span>),
                  <span class="dt">all =</span> <span class="ot">FALSE</span>)

## P(surname | residence) = sum_race P(surname | race) P(race | residence)
indx &lt;-<span class="st"> </span><span class="kw">match</span>(FLVoters$surname, cnames$surname)

FLVoters$name.residence &lt;-<span class="st"> </span>cnames$name.white[indx] *<span class="st"> </span>FLVoters$white +
<span class="st">    </span>cnames$name.black[indx] *<span class="st"> </span>FLVoters$black +
<span class="st">    </span>cnames$name.hispanic[indx] *<span class="st"> </span>FLVoters$hispanic +
<span class="st">    </span>cnames$name.asian[indx] *<span class="st"> </span>FLVoters$api +
<span class="st">    </span>cnames$name.others[indx] *<span class="st"> </span>FLVoters$others

## P(race | surname, residence) = P(surname | race) * P(race | residence)
##                                / P(surname | residence)
FLVoters$pre.white &lt;-<span class="st"> </span>cnames$name.white[indx] *<span class="st"> </span>FLVoters$white /
<span class="st">    </span>FLVoters$name.residence

FLVoters$pre.black &lt;-<span class="st"> </span>cnames$name.black[indx] *<span class="st"> </span>FLVoters$black /
<span class="st">    </span>FLVoters$name.residence

FLVoters$pre.hispanic &lt;-<span class="st"> </span>cnames$name.hispanic[indx] *<span class="st"> </span>FLVoters$hispanic /
<span class="st">    </span>FLVoters$name.residence

FLVoters$pre.asian &lt;-<span class="st"> </span>cnames$name.asian[indx] *<span class="st"> </span>FLVoters$api /
<span class="st">    </span>FLVoters$name.residence

FLVoters$pre.others &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span>FLVoters$pre.white -<span class="st"> </span>FLVoters$pre.black -
<span class="st">    </span>FLVoters$pre.hispanic -<span class="st"> </span>FLVoters$pre.asian

## relevant variables
vars1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"pre.white"</span>, <span class="st">"pre.black"</span>, <span class="st">"pre.hispanic"</span>, <span class="st">"pre.asian"</span>,
           <span class="st">"pre.others"</span>)
## whites
whites &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "white"</span>))
<span class="kw">mean</span>(<span class="kw">apply</span>(whites[, vars1], <span class="dv">1</span>, max) ==<span class="st"> </span>whites$pre.white)</code></pre></div>
<pre><code>## [1] 0.9371366</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## blacks
blacks &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "black"</span>))
<span class="kw">mean</span>(<span class="kw">apply</span>(blacks[, vars1], <span class="dv">1</span>, max) ==<span class="st"> </span>blacks$pre.black)</code></pre></div>
<pre><code>## [1] 0.6474954</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Hispanics
hispanics &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "hispanic"</span>))
<span class="kw">mean</span>(<span class="kw">apply</span>(hispanics[, vars1], <span class="dv">1</span>, max) ==<span class="st"> </span>hispanics$pre.hispanic)</code></pre></div>
<pre><code>## [1] 0.85826</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Asians
asians &lt;-<span class="st"> </span><span class="kw">subset</span>(FLVoters, <span class="dt">subset =</span> (race ==<span class="st"> "asian"</span>))
<span class="kw">mean</span>(<span class="kw">apply</span>(asians[, vars1], <span class="dv">1</span>, max) ==<span class="st"> </span>asians$pre.asian)</code></pre></div>
<pre><code>## [1] 0.6071429</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## proportion of blacks among those with surname "White"
cnames$pctblack[cnames$surname ==<span class="st"> "WHITE"</span>]</code></pre></div>
<pre><code>## [1] 27.38</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## predicted probability of being black given residence location
<span class="kw">summary</span>(FLVoters$pre.black[FLVoters$surname ==<span class="st"> "WHITE"</span>])</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Min.</th>
<th align="right">1st Qu.</th>
<th align="right">Median</th>
<th align="right">Mean</th>
<th align="right">3rd Qu.</th>
<th align="right">Max.</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.005207</td>
<td align="right">0.08115</td>
<td align="right">0.1763</td>
<td align="right">0.264</td>
<td align="right">0.32</td>
<td align="right">0.9837</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## whites
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(FLVoters[, vars1], <span class="dv">1</span>, max) ==
<span class="st">                           </span>FLVoters$pre.white] ==<span class="st"> "white"</span>)</code></pre></div>
<pre><code>## [1] 0.1187425</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## blacks
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(FLVoters[, vars1], <span class="dv">1</span>, max) ==
<span class="st">                           </span>FLVoters$pre.black] ==<span class="st"> "black"</span>)</code></pre></div>
<pre><code>## [1] 0.2346491</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Hispanics
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(FLVoters[, vars1], <span class="dv">1</span>, max) ==
<span class="st">                           </span>FLVoters$pre.hispanic] ==<span class="st"> "hispanic"</span>)</code></pre></div>
<pre><code>## [1] 0.2153709</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Asians
<span class="dv">1</span> -<span class="st"> </span><span class="kw">mean</span>(FLVoters$race[<span class="kw">apply</span>(FLVoters[, vars1], <span class="dv">1</span>, max) ==
<span class="st">                           </span>FLVoters$pre.asian] ==<span class="st"> "asian"</span>)</code></pre></div>
<pre><code>## [1] 0.3461538</code></pre>
</div>
</div>
<div id="section-6-3-random-variables-and-probability-distributions" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-6-3-random-variables-and-probability-distributions" class="anchor"> </a></body></html>Section 6.3: Random Variables and Probability Distributions</h2>
<div id="section-6-3-1-random-variables" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-3-1-random-variables" class="anchor"> </a></body></html>Section 6.3.1: Random Variables</h3>
</div>
<div id="section-6-3-2-bernoulli-and-uniform-distributions" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-3-2-bernoulli-and-uniform-distributions" class="anchor"> </a></body></html>Section 6.3.2: Bernoulli and Uniform Distributions</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## uniform PDF: x = 0.5, interval = [0, 1]
<span class="kw">dunif</span>(<span class="fl">0.5</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## uniform CDF: x = 1, interval = [-2, 2]
<span class="kw">punif</span>(<span class="dv">1</span>, <span class="dt">min =</span> -<span class="dv">2</span>, <span class="dt">max =</span> <span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.75</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sims &lt;-<span class="st"> </span><span class="dv">1000</span>
p &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co"># success probabilities</span>
x &lt;-<span class="st"> </span><span class="kw">runif</span>(sims, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>) <span class="co"># uniform [0, 1]</span>
<span class="kw">head</span>(x)</code></pre></div>
<pre><code>## [1] 0.4248609 0.2555075 0.3536411 0.3963036 0.8440048 0.2878646</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">as.integer</span>(x &lt;=<span class="st"> </span>p) <span class="co"># Bernoulli; turn TRUE/FALSE to 1/0</span>
<span class="kw">head</span>(y)</code></pre></div>
<pre><code>## [1] 1 1 1 1 0 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(y) <span class="co"># close to success probability p, proportion of 1's vs. 0's</span></code></pre></div>
<pre><code>## [1] 0.484</code></pre>
</div>
<div id="section-6-3-3-binomial-distribution" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-3-3-binomial-distribution" class="anchor"> </a></body></html>Section 6.3.3: Binomial Distribution</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## PMF when x = 2, n = 3, p = 0.5
<span class="kw">dbinom</span>(<span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 0.375</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## CDF when x = 1, n = 3, p = 0.5
<span class="kw">pbinom</span>(<span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 0.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## number of voters who turn out
voters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1000</span>, <span class="dv">10000</span>, <span class="dv">100000</span>)
<span class="kw">dbinom</span>(voters /<span class="st"> </span><span class="dv">2</span>, <span class="dt">size =</span> voters, <span class="dt">prob =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 0.025225018 0.007978646 0.002523126</code></pre>
</div>
<div id="section-6-3-4-normal-distribution" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-3-4-normal-distribution" class="anchor"> </a></body></html>Section 6.3.4: Normal Distribution</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## plus minus one standard deviation from the mean
<span class="kw">pnorm</span>(<span class="dv">1</span>) -<span class="st"> </span><span class="kw">pnorm</span>(-<span class="dv">1</span>)

## plus minus two standard deviations from the mean
<span class="kw">pnorm</span>(<span class="dv">2</span>) -<span class="st"> </span><span class="kw">pnorm</span>(-<span class="dv">2</span>)

mu &lt;-<span class="st"> </span><span class="dv">5</span>
sigma &lt;-<span class="st"> </span><span class="dv">2</span>

## plus minus one standard deviation from the mean
<span class="kw">pnorm</span>(mu +<span class="st"> </span>sigma, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">2</span>) -<span class="st"> </span><span class="kw">pnorm</span>(mu -<span class="st"> </span>sigma, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">2</span>)

## plus minus two standard deviations from the mean
<span class="kw">pnorm</span>(mu +<span class="st"> </span><span class="dv">2</span>*sigma, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">2</span>) -<span class="st"> </span><span class="kw">pnorm</span>(mu -<span class="st"> </span><span class="dv">2</span>*sigma, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">2</span>)

## see the page reference above
## `Obama2012.z' is Obama's 2012 standardized vote share
## `Obama2008.z' is Obama's 2008 standardized vote share
fit1

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.5</span>)
e &lt;-<span class="st"> </span><span class="kw">resid</span>(fit1)

## z-score of residuals
e.zscore &lt;-<span class="st"> </span><span class="kw">scale</span>(e)

## alternatively we can divide residuals by their standard deviation
e.zscore &lt;-<span class="st"> </span>e /<span class="st"> </span><span class="kw">sd</span>(e)

<span class="kw">hist</span>(e.zscore, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>),
     <span class="dt">xlab =</span> <span class="st">"Standardized residuals"</span>,
     <span class="dt">main =</span> <span class="st">"Distribution of standardized residuals"</span>)

x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> -<span class="dv">3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)
<span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x)) <span class="co"># overlay the Normal density</span>
<span class="kw">qqnorm</span>(e.zscore, <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="dv">3</span>, <span class="dv">3</span>)) <span class="co"># quantile-quantile plot</span>

<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># 45 degree line</span>

e.sd &lt;-<span class="st"> </span><span class="kw">sd</span>(e)
e.sd

CA<span class="fl">.2008</span> &lt;-<span class="st"> </span>pres$Obama2008.z[pres$state ==<span class="st"> "CA"</span>]
CA<span class="fl">.2008</span>

CA.mean2012 &lt;-<span class="st"> </span><span class="kw">coef</span>(fit1) *<span class="st"> </span>CA<span class="fl">.2008</span>
CA.mean2012

## area to the right; greater than CA.2008
<span class="kw">pnorm</span>(CA<span class="fl">.2008</span>, <span class="dt">mean =</span> CA.mean2012, <span class="dt">sd =</span> e.sd, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)

TX<span class="fl">.2008</span> &lt;-<span class="st"> </span>pres$Obama2008.z[pres$state ==<span class="st"> "TX"</span>]
TX.mean2012 &lt;-<span class="st"> </span><span class="kw">coef</span>(fit1) *<span class="st"> </span>TX<span class="fl">.2008</span>
TX.mean2012

<span class="kw">pnorm</span>(TX<span class="fl">.2008</span>, <span class="dt">mean =</span> TX.mean2012, <span class="dt">sd =</span> e.sd, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</code></pre></div>
</div>
<div id="section-6-3-5-expectation-and-variance" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-3-5-expectation-and-variance" class="anchor"> </a></body></html>Section 6.3.5: Expectation and Variance</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## theoretical variance: p was set to 0.5 earlier
p *<span class="st"> </span>(<span class="dv">1</span>-p)</code></pre></div>
<pre><code>## [1] 0.25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## sample variance using `y' generated earlier
<span class="kw">var</span>(y)</code></pre></div>
<pre><code>## [1] 0.249994</code></pre>
</div>
<div id="section-6-3-6-predicting-election-outcomes-with-uncertainty" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-3-6-predicting-election-outcomes-with-uncertainty" class="anchor"> </a></body></html>Section 6.3.6: Predicting Election Outcomes with Uncertainty</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"pres08"</span>, <span class="dt">package =</span> <span class="st">"qss"</span>)

## two-party vote share
pres08$p &lt;-<span class="st"> </span>pres08$Obama /<span class="st"> </span>(pres08$Obama +<span class="st"> </span>pres08$McCain)

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.5</span>)
n.states &lt;-<span class="st"> </span><span class="kw">nrow</span>(pres08) <span class="co"># number of states</span>
n &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># number of respondents</span>
sims &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co"># number of simulations</span>

## Obama's electoral votes
Obama.ev &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, sims)

for (i in <span class="dv">1</span>:sims) {
    ## samples number of votes for Obama in each state
    draws &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n.states, <span class="dt">size =</span> n, <span class="dt">prob =</span> pres08$p)
    ## sums state's electoral college votes if Obama wins the majority
    Obama.ev[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(pres08$EV[draws &gt;<span class="st"> </span>n /<span class="st"> </span><span class="dv">2</span>])
}

<span class="kw">hist</span>(Obama.ev, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">"Prediction of election outcome"</span>,
     <span class="dt">xlab =</span> <span class="st">"Obama's electoral college votes"</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="dv">364</span>, <span class="dt">col =</span> <span class="st">"red"</span>) <span class="co"># actual result</span></code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(Obama.ev)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">Min.</th>
<th align="right">1st Qu.</th>
<th align="right">Median</th>
<th align="right">Mean</th>
<th align="right">3rd Qu.</th>
<th align="right">Max.</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">289</td>
<td align="right">340</td>
<td align="right">353</td>
<td align="right">352.1</td>
<td align="right">364</td>
<td align="right">398</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(Obama.ev)</code></pre></div>
<pre><code>## [1] 352.142</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## probability of binomial random variable taking greater than n/2 votes
<span class="kw">sum</span>(pres08$EV *<span class="st"> </span><span class="kw">pbinom</span>(n /<span class="st"> </span><span class="dv">2</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> pres08$p, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))</code></pre></div>
<pre><code>## [1] 352.1388</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## approximate variance using Monte Carlo draws
<span class="kw">var</span>(Obama.ev)</code></pre></div>
<pre><code>## [1] 262.9825</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## theoretical variance
pres08$pb &lt;-<span class="st"> </span><span class="kw">pbinom</span>(n /<span class="st"> </span><span class="dv">2</span>, <span class="dt">size =</span> n, <span class="dt">prob =</span> pres08$p, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)
V &lt;-<span class="st"> </span><span class="kw">sum</span>(pres08$pb *<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>pres08$pb) *<span class="st"> </span>pres08$EV^<span class="dv">2</span>)
V</code></pre></div>
<pre><code>## [1] 268.8008</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## approximate standard deviation using Monte Carlo draws
<span class="kw">sd</span>(Obama.ev)</code></pre></div>
<pre><code>## [1] 16.21674</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## theoretical standard deviation
<span class="kw">sqrt</span>(V)</code></pre></div>
<pre><code>## [1] 16.39515</code></pre>
</div>
</div>
<div id="section-6-4-large-sample-theorems" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-6-4-large-sample-theorems" class="anchor"> </a></body></html>Section 6.4: Large Sample Theorems</h2>
<div id="section-6-4-1-the-law-of-large-numbers" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-4-1-the-law-of-large-numbers" class="anchor"> </a></body></html>Section 6.4.1: The Law of Large Numbers</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sims &lt;-<span class="st"> </span><span class="dv">1000</span>

## 3 separate simulations for each
x.binom &lt;-<span class="st"> </span><span class="kw">rbinom</span>(sims, <span class="dt">p =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">10</span>)

## computing sample mean with varying sample size
mean.binom &lt;-<span class="st"> </span><span class="kw">cumsum</span>(x.binom) /<span class="st"> </span><span class="dv">1</span>:sims

## default runif() is uniform(0, 1)
x.unif &lt;-<span class="st"> </span><span class="kw">runif</span>(sims)
mean.unif &lt;-<span class="st"> </span><span class="kw">cumsum</span>(x.unif) /<span class="st"> </span><span class="dv">1</span>:sims

<span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.5</span>)
## plot for binomial
<span class="kw">plot</span>(<span class="dv">1</span>:sims, mean.binom, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),
     <span class="dt">xlab =</span> <span class="st">"Sample size"</span>, <span class="dt">ylab =</span> <span class="st">"Sample mean"</span>, <span class="dt">main =</span> <span class="st">"Binomial(10, 0.2)"</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="st">"dashed"</span>) <span class="co"># expectation</span></code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## plot for uniform
<span class="kw">plot</span>(<span class="dv">1</span>:sims, mean.unif, <span class="dt">type =</span> <span class="st">"l"</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),
     <span class="dt">xlab =</span> <span class="st">"Sample size"</span>, <span class="dt">ylab =</span> <span class="st">"Sample mean"</span>, <span class="dt">main =</span> <span class="st">"Uniform(0, 1)"</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.5</span>, <span class="dt">lty =</span> <span class="st">"dashed"</span>) <span class="co"># expectation</span></code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-13-2.png" width="672"></p>
</div>
<div id="section-6-4-2-the-central-limit-theorem" class="section level3">
<h3 class="hasAnchor">
<html><body><a href="#section-6-4-2-the-central-limit-theorem" class="anchor"> </a></body></html>Section 6.4.2: The Central Limit Theorem</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">cex =</span> <span class="fl">1.5</span>)
## sims = number of simulations
n.samp &lt;-<span class="st"> </span><span class="dv">1000</span>
z.binom &lt;-<span class="st"> </span>z.unif &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, sims)

for (i in <span class="dv">1</span>:sims) {
    x &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n.samp, <span class="dt">p =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="dv">10</span>)
    z.binom[i] &lt;-<span class="st"> </span>(<span class="kw">mean</span>(x) -<span class="st"> </span><span class="dv">2</span>) /<span class="st"> </span><span class="kw">sqrt</span>(<span class="fl">1.6</span> /<span class="st"> </span>n.samp)
    x &lt;-<span class="st"> </span><span class="kw">runif</span>(n.samp, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>)
    z.unif[i] &lt;-<span class="st"> </span>(<span class="kw">mean</span>(x) -<span class="st"> </span><span class="fl">0.5</span>) /<span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">1</span> /<span class="st"> </span>(<span class="dv">12</span> *<span class="st"> </span>n.samp))
}

## histograms; nclass specifies the number of bins
<span class="kw">hist</span>(z.binom, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">nclass =</span> <span class="dv">40</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">4</span>, <span class="dv">4</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>),
     <span class="dt">xlab =</span> <span class="st">"z-score"</span>, <span class="dt">main =</span> <span class="st">"Binomial(0.2, 10)"</span>)

x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> -<span class="dv">3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)
<span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x)) <span class="co"># overlay the standard Normal PDF</span></code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(z.unif, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">nclass =</span> <span class="dv">40</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="dv">4</span>, <span class="dv">4</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>),
     <span class="dt">xlab =</span> <span class="st">"z-score"</span>, <span class="dt">main =</span> <span class="st">"Uniform(0, 1)"</span>)
<span class="kw">lines</span>(x, <span class="kw">dnorm</span>(x))</code></pre></div>
<p><img src="probability_files/figure-html/unnamed-chunk-14-2.png" width="672"></p>
</div>
</div>
<div id="section-6-5-summary" class="section level2">
<h2 class="hasAnchor">
<html><body><a href="#section-6-5-summary" class="anchor"> </a></body></html>Section 6.5: Summary</h2>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#chapter-6-probability">Chapter 6: Probability</a><ul class="nav nav-pills nav-stacked">
<li><a href="#section-6.1-probability">Section 6.1: Probability</a></li>
      <li><a href="#section-6.2-conditional-probability">Section 6.2: Conditional Probability</a></li>
      <li><a href="#section-6.3-random-variables-and-probability-distributions">Section 6.3: Random Variables and Probability Distributions</a></li>
      <li><a href="#section-6.4-large-sample-theorems">Section 6.4: Large Sample Theorems</a></li>
      <li><a href="#section-6.5-summary">Section 6.5: Summary</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jeffey Arnold, Kosuke Imai, Tyler Simko.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
